# Copyright (c) 2021 Andrew Archibald
#
# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at https://mozilla.org/MPL/2.0/.

# Bitwise tests borrowed from Go
# https://golang.org/src/math/big/int_test.go#L1193

0      0      call test_bitwise
0      1      call test_bitwise
1      0      call test_bitwise
-1     0      call test_bitwise
-175   -80    call test_bitwise
0      -1     call test_bitwise
1      1      call test_bitwise
-1     -1     call test_bitwise
7      8      call test_bitwise
5      15     call test_bitwise
255    -10    call test_bitwise
81910  39502  call test_bitwise
-81910 39502  call test_bitwise
-81910 -39502 call test_bitwise

340282566926938463463474637401768211457
298472983472983471903246121093472394872319615612417471234712061
call test_bitwise

340282566926938463463474637401768211457
-298472983472983471903246121093472394872319615612417471234712061
call test_bitwise

-340282566926938463463474637401768211457
-298472983472983471903246121093472394872319615612417471234712061
call test_bitwise

0      call test_not
1      call test_not
7      call test_not
0      call test_not
-81910 call test_not
298472983472983471903246121093472394872319615612417471234712061 call test_not

end

# (x y -- )
test_bitwise:
    'x' printc ' ' printc ^1 printi '\n' printc
    'y' printc ' ' printc ^ printi '\n' printc

    'x' printc '&' printc 'y' printc ' ' printc
    ^1 ^1 call and printi '\n' printc

    'x' printc '|' printc 'y' printc ' ' printc
    ^1 ^1 call or printi '\n' printc

    'x' printc '^' printc 'y' printc ' ' printc
    ^1 ^1 call xor printi '\n' printc

    'x' printc '&' printc '^' printc 'y' printc ' ' printc
    ^1 ^1 call andnot printi '\n' printc

    '\n' printc
    2drop ret

# (x -- )
test_not:
    'x' printc ' ' printc ^ printi '\n' printc
    '-' printc 'x' printc ' ' printc
    call not printi '\n' printc '\n' printc
    ret
